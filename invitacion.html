<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AR con Ajuste NFT</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        .arjs-loader { 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: white; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 1000;
        }
    </style>
</head>
<body>
    <a-scene 
        vr-mode-ui="enabled: false"
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
        renderer="logarithmicDepthBuffer: true; antialias: true;"
    >
        <!-- Iluminación mejorada -->
        <a-entity light="type: ambient; intensity: 0.8"></a-entity>
        <a-entity light="type: directional; intensity: 1.5" position="-1 2 1"></a-entity>

        <a-assets>
            <a-asset-item id="model" src="models/VOLADOR_100x.glb"></a-asset-item>
        </a-assets>

        <!-- Marcador NFT con ajustes especiales -->
        <a-nft 
            type="nft"
            url="invitacion/nft/invitacion"
            smooth="true"
            smoothCount="5"
            smoothTolerance="0.01"
            emiteEvents="true"
        >
            <a-entity
                gltf-model="#model"
                scale="10 10 10"
                position="0 0 0"
                rotation="-90 0 0"
                gltf-model-node="normalize: true"
              ></a-entity>
        </a-nft>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Ocultar loader y debuggear
        const scene = document.querySelector('a-scene');
        const model = document.getElementById('model-entity');
        
        scene.addEventListener('loaded', () => {
            document.querySelector('.arjs-loader').style.display = 'none';
            
            // Debug: Ver posición en consola
            setInterval(() => {
                const pos = model.getAttribute('position');
                console.log('Posición actual:', pos);
            }, 2000);
        });

        // Ajustes específicos para NFT
        document.querySelector('a-nft').addEventListener('markerFound', () => {
            console.log("Modelo visible con NFT");
        });
        // Añade este script para ajustes en tiempo real
        const model2 = document.querySelector('[gltf-model]');
        const marcadorA4 = {
          ancho: 0.21,  // 21cm en metros
          alto: 0.297   // 29.7cm en metros
        };
        
        // Centrado automático considerando las dimensiones
        model2.setAttribute('position', {
          x: 0, 
          y: marcadorA4.alto/2, 
          z: 0
        });
        
        // Debuggeo visual
        console.log("Modelo centrado en:", {
          x: 0,
          y: marcadorA4.alto/2,
          z: 0
        });
    </script>
</body>
</html>
